<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MIDI Note Viewer</title>
  <style>
    body { font-family: Arial; background:#111; color:#eee; padding:40px; }
    h1 { color:#0f0; }
    #log { 
      white-space: pre-wrap; 
      background:#222; 
      padding:20px; 
      border-radius:10px; 
      height: 400px;       /* fixed height */
      overflow-y: auto;    /* internal scroll */
    }
    nav a { color: #0f0; text-decoration: none; margin-right: 15px; }
    nav a:hover { text-decoration: underline; }
  </style>
</head>
<body>

<nav>
  <a href="index.html">MIDI Note Viewer</a> |
  <a href="page2.html">Pattern Checker</a>  |
  <a href="page3.html">Custom Pattern Checker</a>  |
  <a href="references.html">References</a>  |
</nav>

<h1>MIDI Note Viewer</h1>
<p>Plug in your MIDI keyboard and press keys. Notes will appear below.</p>
<div id="status">Initializing MIDI...</div>
<div id="log"></div>

<script>
const logBox = document.getElementById("log");
const statusBox = document.getElementById("status");

// Updated log function: auto-scrolls to latest input
function log(msg) {
  logBox.textContent += msg + "\n";
  logBox.scrollTop = logBox.scrollHeight; // auto-scroll to bottom
}

async function initMIDI() {
  try {
    const access = await navigator.requestMIDIAccess();
    statusBox.textContent = "MIDI ready! Play your keyboard.";

    for (let input of access.inputs.values()) {
      log("Connected to: " + input.name);

      input.onmidimessage = (msg) => {
        const [command, note, velocity] = msg.data;
        const NOTE_ON = (command === 0x90 && velocity > 0);
        const NOTE_OFF = (command === 0x80) || (command === 0x90 && velocity === 0);

        if (NOTE_ON) {
          log(`Note ON: ${note}`);
        } else if (NOTE_OFF) {
          log(`Note OFF: ${note}`);
        }
      };
    }

  } catch (err) {
    statusBox.textContent = "Failed to access MIDI.";
    log(err);
  }
}

initMIDI();
</script>

</body>
</html>


